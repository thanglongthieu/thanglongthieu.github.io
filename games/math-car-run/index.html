<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Two Cars ‚Äì Physics Fraction Lab</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #050510;
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      overflow: hidden;
      touch-action: none;
      -webkit-user-select: none;
      user-select: none;
    }

    .app {
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .header {
      text-align: center;
    }

    .title {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 13px;
      opacity: 0.8;
    }

    .top-bar {
      margin-top: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      gap: 6px;
    }

    .quiz-info span {
      margin-right: 8px;
    }

    .badge {
      border-radius: 999px;
      padding: 2px 7px;
      background: rgba(255,255,255,0.1);
      font-size: 11px;
    }

    .inputs {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
      font-size: 14px;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: nowrap;
    }

    .row label {
      flex: 0 0 155px;
    }

    .row input {
      flex: 1;
      padding: 6px 8px;
      border-radius: 6px;
      border: none;
      font-size: 14px;
    }

    .row span.unit {
      font-size: 12px;
      opacity: 0.8;
      flex: 0 0 auto;
    }

    .answer-fraction {
      display: flex;
      align-items: center;
      gap: 4px;
      flex: 1;
    }

    .answer-fraction input {
      width: 30%;
    }

    .button-row {
      margin-top: 6px;
      display: flex;
      justify-content: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 7px 12px;
      font-size: 13px;
      border-radius: 999px;
      border: none;
      background: #1c1c2e;
      color: #fff;
      box-shadow: 0 3px 8px rgba(0,0,0,0.5);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background-color 0.1s ease;
    }

    .btn.primary {
      background: #0a84ff;
      box-shadow: 0 3px 10px rgba(10,132,255,0.7);
    }

    .btn:active {
      transform: translateY(1px) scale(0.97);
      box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    }

    .result-box {
      margin-top: 6px;
      padding: 6px 8px;
      border-radius: 8px;
      background: rgba(0,0,0,0.35);
      font-size: 12px;
    }

    .result-line {
      margin: 2px 0;
    }

    .highlight {
      color: #ffd60a;
      font-weight: 600;
    }

    .correct-text {
      color: #30d158;
      font-weight: 600;
    }

    .wrong-text {
      color: #ff453a;
      font-weight: 600;
    }

    .sim-and-graph {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
      min-height: 200px;
    }

    .sim-title, .graph-title {
      font-size: 12px;
      opacity: 0.85;
      text-align: center;
    }

    .sim-area {
      position: relative;
      flex: 0 0 130px;
      border-radius: 10px;
      background: linear-gradient(#1c1c2e 0, #1c1c2e 50%, #111 50%, #111 100%);
      box-shadow: 0 0 10px rgba(0,0,0,0.7);
      overflow: hidden;
    }

    .road {
      position: absolute;
      left: 10px;
      right: 10px;
      bottom: 40px;
      height: 40px;
      background: #333;
      border-radius: 20px;
      box-shadow: inset 0 0 6px rgba(0,0,0,0.8);
    }

    .road-line {
      position: absolute;
      left: 12px;
      right: 12px;
      top: 17px;
      height: 6px;
      background-image: linear-gradient(90deg,
        #ddd 0, #ddd 30px,
        transparent 30px, transparent 45px);
      background-size: 45px 6px;
      opacity: 0.9;
    }

    .car {
      position: absolute;
      bottom: 52px;
      width: 26px;
      height: 16px;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #000;
      box-shadow: 0 2px 4px rgba(0,0,0,0.6);
    }

    .car1 { background: #ffcc00; }
    .car2 { background: #ff453a; }

    .car-label {
      position: absolute;
      bottom: 72px;
      font-size: 11px;
      color: #fff;
      opacity: 0.9;
      transform: translateX(-50%);
      white-space: nowrap;
    }

    .meet-marker {
      position: absolute;
      bottom: 42px;
      width: 2px;
      height: 46px;
      background: #0a84ff;
      display: none;
    }

    .meet-text {
      position: absolute;
      bottom: 92px;
      font-size: 11px;
      color: #0a84ff;
      transform: translateX(-50%);
      white-space: nowrap;
      display: none;
    }

    .graph-area {
      flex: 1;
      border-radius: 10px;
      background: #111;
      box-shadow: 0 0 10px rgba(0,0,0,0.7);
      padding: 6px;
    }

    #graphCanvas {
      width: 100%;
      height: 100%;
      background: #05060a;
      border-radius: 6px;
    }

    .hint-bottom {
      font-size: 11px;
      text-align: center;
      opacity: 0.8;
      margin-top: 2px;
    }
  </style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="title">Two Cars ‚Äì Physics Fraction Lab</div>
    <div class="subtitle">
      Distance is in <b>meters</b>, speeds in <b>m/s</b>.<br>
      Answer: <b>time in hours as a fraction</b> \( t = a/b \).
    </div>
    <div class="top-bar">
      <div class="quiz-info">
        <span>Questions: <span id="qCount">0</span></span>
        <span>Correct: <span id="qCorrect">0</span></span>
        <span>Accuracy: <span id="accuracy">0%</span></span>
      </div>
      <div>
        <span class="badge">Answer: hours as fraction a/b</span>
      </div>
    </div>
  </div>

  <div class="inputs">
    <div class="row">
      <label for="distance">Distance A ‚Üí B:</label>
      <input id="distance" type="number" step="1" min="1" placeholder="e.g. 3000">
      <span class="unit">m</span>
    </div>
    <div class="row">
      <label for="speed1">Speed Car 1 (A‚ÜíB):</label>
      <input id="speed1" type="number" step="1" min="1" placeholder="e.g. 15">
      <span class="unit">m/s</span>
    </div>
    <div class="row">
      <label for="speed2">Speed Car 2 (B‚ÜíA):</label>
      <input id="speed2" type="number" step="1" min="1" placeholder="e.g. 10">
      <span class="unit">m/s</span>
    </div>
    <div class="row">
      <label>Your answer t (hours):</label>
      <div class="answer-fraction">
        <input id="ansNum" type="number" step="1" min="1" placeholder="a">
        <span>/</span>
        <input id="ansDen" type="number" step="1" min="1" placeholder="b">
      </div>
      <span class="unit">hours</span>
    </div>
  </div>

  <div class="button-row">
    <button id="randomBtn" class="btn">üé≤ Random Problem</button>
    <button id="checkBtn" class="btn primary">‚úÖ Check & Show Solution</button>
    <button id="speakBtn" class="btn">üîä Read Question</button>
    <button id="resetQuizBtn" class="btn">‚ôª Reset Stats</button>
  </div>

  <div class="result-box" id="resultBox">
    <div class="result-line">
      Formula: <span class="highlight">t = distance / (v‚ÇÅ + v‚ÇÇ)</span> (in seconds)
    </div>
    <div class="result-line" id="fractionLine">Step 1 (seconds): ‚Äî</div>
    <div class="result-line" id="hourFractionLine">Step 2 (hours, as fraction): ‚Äî</div>
    <div class="result-line" id="decimalLine">Decimal: ‚Äî</div>
    <div class="result-line" id="timeLine">Meeting time: ‚Äî</div>
    <div class="result-line" id="positionLine">Meeting position: ‚Äî</div>
    <div class="result-line" id="quizFeedback">Quiz: ‚Äî</div>
  </div>

  <div class="sim-and-graph">
    <div>
      <div class="sim-title">
        Simulation (not to scale): cars move until they meet.
      </div>
      <div class="sim-area" id="simArea">
        <div class="road">
          <div class="road-line"></div>
        </div>
        <div class="car car1" id="car1">1</div>
        <div class="car car2" id="car2">2</div>
        <div class="car-label" id="label1">Car 1 (A‚ÜíB)</div>
        <div class="car-label" id="label2">Car 2 (B‚ÜíA)</div>
        <div class="meet-marker" id="meetMarker"></div>
        <div class="meet-text" id="meetText">Meet here</div>
      </div>
    </div>

    <div class="graph-area">
      <div class="graph-title">
        Distance‚Äìtime graph (distance from A in meters)
      </div>
      <canvas id="graphCanvas"></canvas>
    </div>

    <div class="hint-bottom">
      iPhone: fill in, then tap <b>‚ÄúCheck & Show Solution‚Äù</b>.<br>
      Use <b>Random</b> for practice.
    </div>
  </div>
</div>

<script>
  // --- DOM ---
  const distanceInput = document.getElementById('distance');
  const speed1Input = document.getElementById('speed1');
  const speed2Input = document.getElementById('speed2');
  const ansNumInput = document.getElementById('ansNum');
  const ansDenInput = document.getElementById('ansDen');

  const randomBtn = document.getElementById('randomBtn');
  const checkBtn = document.getElementById('checkBtn');
  const speakBtn = document.getElementById('speakBtn');
  const resetQuizBtn = document.getElementById('resetQuizBtn');

  const fractionLine = document.getElementById('fractionLine');
  const hourFractionLine = document.getElementById('hourFractionLine');
  const decimalLine = document.getElementById('decimalLine');
  const timeLine = document.getElementById('timeLine');
  const positionLine = document.getElementById('positionLine');
  const quizFeedback = document.getElementById('quizFeedback');

  const qCountSpan = document.getElementById('qCount');
  const qCorrectSpan = document.getElementById('qCorrect');
  const accuracySpan = document.getElementById('accuracy');

  const simArea = document.getElementById('simArea');
  const car1El = document.getElementById('car1');
  const car2El = document.getElementById('car2');
  const label1El = document.getElementById('label1');
  const label2El = document.getElementById('label2');
  const meetMarkerEl = document.getElementById('meetMarker');
  const meetTextEl = document.getElementById('meetText');

  const graphCanvas = document.getElementById('graphCanvas');
  const gctx = graphCanvas.getContext('2d');

  // --- Simulation state ---
  let animReq = null;
  let simStartTime = 0;
  let simDuration = 8000; // ms
  let roadLeft = 0;
  let roadRight = 0;
  let meetingX = 0;

  // --- Last computed problem (for sim + graph) ---
  let lastDistance = null; // m
  let lastSpeed1 = null;   // m/s
  let lastSpeed2 = null;   // m/s
  let lastTHours = null;
  let lastD1 = null;       // m
  let lastD2 = null;

  // --- Quiz state ---
  let totalQuestions = 0;
  let correctAnswers = 0;

  function updateQuizStats() {
    qCountSpan.textContent = totalQuestions;
    qCorrectSpan.textContent = correctAnswers;
    const acc = totalQuestions > 0 ? (100 * correctAnswers / totalQuestions) : 0;
    accuracySpan.textContent = acc.toFixed(0) + '%';
  }

  // --- Helpers ---
  function gcd(a, b) {
    a = Math.abs(a);
    b = Math.abs(b);
    while (b !== 0) {
      const t = b;
      b = a % b;
      a = t;
    }
    return a || 1;
  }

  function formatTimeFromHours(tHours) {
    const totalMinutes = tHours * 60;
    const hours = Math.floor(totalMinutes / 60);
    const minutes = totalMinutes % 60;
    if (hours <= 0) {
      return `${minutes.toFixed(1)} minutes`;
    } else {
      return `${hours} h ${minutes.toFixed(1)} min`;
    }
  }

  // --- Simulation layout ---
  function stopAnimation() {
    if (animReq !== null) {
      cancelAnimationFrame(animReq);
      animReq = null;
    }
  }

  function layoutPositions() {
    const road = simArea.querySelector('.road');
    const roadRect = road.getBoundingClientRect();
    const simRect = simArea.getBoundingClientRect();

    roadLeft = roadRect.left - simRect.left;
    roadRight = roadRect.right - simRect.left;

    const startX1 = roadLeft;
    const startX2 = roadRight;

    car1El.style.left = `${startX1 - car1El.offsetWidth / 2}px`;
    car2El.style.left = `${startX2 - car2El.offsetWidth / 2}px`;

    label1El.style.left = `${startX1}px`;
    label2El.style.left = `${startX2}px`;

    meetMarkerEl.style.display = 'none';
    meetTextEl.style.display = 'none';
  }

  function startSimulation() {
    // need valid data
    if (!(lastDistance > 0 && lastSpeed1 > 0 && lastSpeed2 > 0 && lastTHours > 0 && lastD1 >= 0)) {
      return;
    }

    stopAnimation();
    layoutPositions();

    const roadLengthPx = roadRight - roadLeft;
    const startX1 = roadLeft;
    const startX2 = roadRight;

    // ‚úÖ FIX: use lastD1 (distance car 1 actually travels to meeting point)
    const d1 = lastD1; // meters
    const ratio = lastDistance > 0 ? d1 / lastDistance : 0.5;
    const clampedRatio = Math.max(0, Math.min(1, ratio));

    meetingX = roadLeft + clampedRatio * roadLengthPx;

    meetMarkerEl.style.left = `${meetingX - 1}px`;
    meetTextEl.style.left = `${meetingX}px`;
    meetMarkerEl.style.display = 'block';
    meetTextEl.style.display = 'block';

    simStartTime = performance.now();

    function step(now) {
      const elapsed = now - simStartTime;
      const alpha = Math.min(1, elapsed / simDuration);

      const x1 = startX1 + (meetingX - startX1) * alpha;
      const x2 = startX2 + (meetingX - startX2) * alpha;

      car1El.style.left = `${x1 - car1El.offsetWidth / 2}px`;
      car2El.style.left = `${x2 - car2El.offsetWidth / 2}px`;

      label1El.style.left = `${x1}px`;
      label2El.style.left = `${x2}px`;

      if (alpha < 1) {
        animReq = requestAnimationFrame(step);
      } else {
        animReq = null;
      }
    }

    animReq = requestAnimationFrame(step);
  }

  // --- Graph ---
  function resizeGraphCanvas() {
    const rect = graphCanvas.getBoundingClientRect();
    graphCanvas.width = rect.width;
    graphCanvas.height = rect.height;
  }

  function drawGraph() {
    resizeGraphCanvas();
    const ctx = gctx;
    const w = graphCanvas.width;
    const h = graphCanvas.height;
    ctx.clearRect(0, 0, w, h);

    if (!(lastDistance > 0 && lastTHours > 0)) {
      ctx.fillStyle = '#666';
      ctx.font = '12px -apple-system, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('Solve a problem to see the graph.', w / 2, h / 2);
      return;
    }

    const marginLeft = 34;
    const marginRight = 10;
    const marginTop = 10;
    const marginBottom = 22;

    const innerW = w - marginLeft - marginRight;
    const innerH = h - marginTop - marginBottom;

    const maxT = lastTHours;
    const maxD = lastDistance;

    function xFromT(t) {
      return marginLeft + (t / maxT) * innerW;
    }
    function yFromD(d) {
      return h - marginBottom - (d / maxD) * innerH;
    }

    // axes
    ctx.strokeStyle = '#888';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(marginLeft, h - marginBottom);
    ctx.lineTo(w - marginRight, h - marginBottom);
    ctx.moveTo(marginLeft, h - marginBottom);
    ctx.lineTo(marginLeft, marginTop);
    ctx.stroke();

    ctx.fillStyle = '#aaa';
    ctx.font = '10px -apple-system, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('time (h)', (w + marginLeft - marginRight) / 2, h - 6);

    ctx.save();
    ctx.translate(10, (h - marginBottom + marginTop) / 2);
    ctx.rotate(-Math.PI / 2);
    ctx.textAlign = 'center';
    ctx.fillText('distance (m)', 0, 0);
    ctx.restore();

    // ticks
    ctx.fillStyle = '#777';
    const tSteps = 4;
    ctx.textAlign = 'center';
    for (let i = 0; i <= tSteps; i++) {
      const t = (maxT * i) / tSteps;
      const x = xFromT(t);
      const y = h - marginBottom;
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.lineTo(x, y + 3);
      ctx.strokeStyle = '#555';
      ctx.stroke();
      ctx.fillText(t.toFixed(2), x, y + 12);
    }

    const dSteps = 4;
    ctx.textAlign = 'right';
    for (let i = 0; i <= dSteps; i++) {
      const d = (maxD * i) / dSteps;
      const x = marginLeft;
      const y = yFromD(d);
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.lineTo(x - 3, y);
      ctx.strokeStyle = '#555';
      ctx.stroke();
      ctx.fillText(d.toFixed(0), x - 4, y + 3);
    }

    const v1 = lastSpeed1; // m/s
    const v2 = lastSpeed2; // m/s
    const T = lastTHours;
    const Tsec = T * 3600;

    // Car 1: distance from A (m)
    ctx.strokeStyle = '#ffcc00';
    ctx.lineWidth = 2;
    ctx.beginPath();
    for (let i = 0; i <= 60; i++) {
      const t = (T * i) / 60;   // hours
      const d = v1 * (t * 3600); // m
      const x = xFromT(t);
      const y = yFromD(d);
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    }
    ctx.stroke();

    // Car 2: distance from A (m)
    ctx.strokeStyle = '#ff453a';
    ctx.beginPath();
    for (let i = 0; i <= 60; i++) {
      const t = (T * i) / 60; // h
      const d = lastDistance - v2 * (t * 3600);
      const x = xFromT(t);
      const y = yFromD(d);
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    }
    ctx.stroke();

    // Meeting point
    const meetX = xFromT(T);
    const meetY = yFromD(lastD1);
    ctx.fillStyle = '#0a84ff';
    ctx.beginPath();
    ctx.arc(meetX, meetY, 3, 0, Math.PI * 2);
    ctx.fill();

    ctx.fillStyle = '#ccc';
    ctx.font = '10px -apple-system, sans-serif';
    ctx.textAlign = 'left';
    ctx.fillText('Car 1 (A‚ÜíB)', marginLeft + 6, marginTop + 10);
    ctx.fillStyle = '#ff453a';
    ctx.fillText('Car 2 (B‚ÜíA)', marginLeft + 6, marginTop + 22);
  }

  // --- Solution & quiz ---
  function computeSolution(distance, speed1, speed2) {
    const sumSpeed = speed1 + speed2; // m/s
    const tSeconds = distance / sumSpeed; // seconds
    const tHours = tSeconds / 3600;
    const tMinutes = tHours * 60;

    // Step 1: seconds fraction
    fractionLine.textContent =
      `Step 1: t = distance / (v‚ÇÅ + v‚ÇÇ) = ${distance} / (${speed1} + ${speed2}) = ` +
      `${distance}/${sumSpeed} seconds`;

    // Step 2: hours as fraction: t (hours) = distance / ((v‚ÇÅ + v‚ÇÇ) √ó 3600)
    const denomRaw = sumSpeed * 3600;
    let num = distance;
    let den = denomRaw;

    num = Math.round(num);
    den = Math.round(den);

    const g = gcd(num, den);
    const simpleN = num / g;
    const simpleD = den / g;

    hourFractionLine.textContent =
      `Step 2: t (hours) = ${distance} / (${sumSpeed} √ó 3600) ‚âà ${num}/${den} = ` +
      `${simpleN}/${simpleD} hours`;

    decimalLine.textContent =
      `Decimal: t ‚âà ${tHours.toFixed(6)} h (‚âà ${tMinutes.toFixed(2)} min)`;
    timeLine.textContent = `Meeting time: ${formatTimeFromHours(tHours)}`;

    // Distances from A at meet:
    const d1 = speed1 * tSeconds; // m
    const d2 = distance - d1;
    positionLine.textContent =
      `Meeting position: Car 1 traveled ${d1.toFixed(1)} m from A, ` +
      `Car 2 traveled ${d2.toFixed(1)} m from B.`;

    lastDistance = distance;
    lastSpeed1 = speed1;
    lastSpeed2 = speed2;
    lastTHours = tHours;
    lastD1 = d1;
    lastD2 = d2;

    drawGraph();
    startSimulation();

    return {
      tHours,
      tMinutes,
      fracNum: simpleN,
      fracDen: simpleD
    };
  }

  function checkAnswerAndShow() {
    const distance = parseFloat(distanceInput.value);
    const speed1 = parseFloat(speed1Input.value);
    const speed2 = parseFloat(speed2Input.value);
    const ansNum = parseFloat(ansNumInput.value);
    const ansDen = parseFloat(ansDenInput.value);

    if (!(distance > 0 && speed1 > 0 && speed2 > 0)) {
      alert('Please enter positive numbers for distance and both speeds.');
      return;
    }

    if (!(ansNum > 0 && ansDen > 0)) {
      alert('Please enter your answer as a fraction a/b (both > 0).');
      return;
    }

    const { tHours, tMinutes, fracNum, fracDen } =
      computeSolution(distance, speed1, speed2);

    totalQuestions++;

    // Simplify student's fraction
    const gS = gcd(ansNum, ansDen);
    const sNum = ansNum / gS;
    const sDen = ansDen / gS;

    let isCorrect = false;

    if (Number.isFinite(fracNum) && Number.isFinite(fracDen) &&
        fracNum > 0 && fracDen > 0) {
      if (sNum === fracNum && sDen === fracDen) {
        isCorrect = true;
      } else {
        const studentHours = ansNum / ansDen;
        const diffH = Math.abs(studentHours - tHours);
        isCorrect = diffH <= 1e-3;
      }
    } else {
      const studentHours = ansNum / ansDen;
      const diffH = Math.abs(studentHours - tHours);
      isCorrect = diffH <= 1e-3;
    }

    if (isCorrect) {
      correctAnswers++;
    }
    updateQuizStats();

    if (isCorrect) {
      quizFeedback.innerHTML =
        `Quiz: <span class="correct-text">Correct!</span> ` +
        `(Your: ${sNum}/${sDen}, Real: ${fracNum}/${fracDen}, ` +
        `‚âà ${tMinutes.toFixed(2)} min)`;
    } else {
      quizFeedback.innerHTML =
        `Quiz: <span class="wrong-text">Not quite.</span> ` +
        `(Your: ${sNum}/${sDen}, Real: ${fracNum}/${fracDen}, ` +
        `‚âà ${tMinutes.toFixed(2)} min)`;
    }
  }

  // --- Random problem generator ---
  function generateRandomProblem() {
    const d = 1000 + Math.floor(Math.random() * 40) * 100; // 1000‚Äì5000 m
    let v1, v2, tSec;
    while (true) {
      v1 = 3 + Math.floor(Math.random() * 23);  // 3‚Äì25 m/s
      v2 = 3 + Math.floor(Math.random() * 23);
      tSec = d / (v1 + v2);
      if (tSec >= 30 && tSec <= 7200) break;
    }

    distanceInput.value = d.toString();
    speed1Input.value = v1.toString();
    speed2Input.value = v2.toString();
    ansNumInput.value = '';
    ansDenInput.value = '';

    fractionLine.textContent = 'Step 1 (seconds): ‚Äî';
    hourFractionLine.textContent = 'Step 2 (hours, as fraction): ‚Äî';
    decimalLine.textContent = 'Decimal: ‚Äî';
    timeLine.textContent = 'Meeting time: ‚Äî';
    positionLine.textContent = 'Meeting position: ‚Äî';
    quizFeedback.textContent = 'Quiz: ‚Äî';

    stopAnimation();
    layoutPositions();
    drawGraph();
  }

  // --- Speech (voice read-out) ---
  function speakQuestion() {
    const distance = parseFloat(distanceInput.value);
    const speed1 = parseFloat(speed1Input.value);
    const speed2 = parseFloat(speed2Input.value);

    if (!(distance > 0 && speed1 > 0 && speed2 > 0)) {
      alert('Please enter the distance and both speeds first.');
      return;
    }

    if (!('speechSynthesis' in window)) {
      alert('Speech is not supported in this browser.');
      return;
    }

    const text =
      `We have two cars. The distance from A to B is ${distance} meters. ` +
      `Car one goes from A to B at ${speed1} meters per second. ` +
      `Car two goes from B to A at ${speed2} meters per second. ` +
      `How many hours until they meet? ` +
      `Give your answer as a fraction a over b.`;

    window.speechSynthesis.cancel();
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'en-US';
    utter.rate = 1;
    window.speechSynthesis.speak(utter);
  }

  // --- Quiz reset ---
  function resetQuiz() {
    totalQuestions = 0;
    correctAnswers = 0;
    updateQuizStats();
    quizFeedback.textContent = 'Quiz: ‚Äî';
  }

  // --- Events ---
  randomBtn.addEventListener('pointerdown', (e) => {
    e.preventDefault();
    generateRandomProblem();
  });

  checkBtn.addEventListener('pointerdown', (e) => {
    e.preventDefault();
    checkAnswerAndShow();
  });

  speakBtn.addEventListener('pointerdown', (e) => {
    e.preventDefault();
    speakQuestion();
  });

  resetQuizBtn.addEventListener('pointerdown', (e) => {
    e.preventDefault();
    resetQuiz();
  });

  window.addEventListener('load', () => {
    layoutPositions();
    drawGraph();
    updateQuizStats();
  });

  window.addEventListener('resize', () => {
    layoutPositions();
    drawGraph();
  });
</script>
</body>
</html>
