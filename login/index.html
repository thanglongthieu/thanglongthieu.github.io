---
layout: default
title: "Salesforce Login & Signup | Andi & Anna"
---
<section class="space-y-10">
  <div class="flex flex-wrap items-start justify-between gap-4">
    <div class="space-y-3">
      <div class="inline-flex items-center gap-2 rounded-full bg-blue-100 px-4 py-2 text-sm font-semibold text-blue-700 ring-1 ring-blue-200">
        üîê Salesforce Auth via JSforce
      </div>
      <h1 class="text-3xl font-bold text-slate-900">Signup &amp; Login Console</h1>
      <p class="max-w-3xl text-slate-600">
        Connect with your Salesforce credentials or SSO provider, then create Leads for signups without leaving the browser.
        Credentials never leave your session; use a sandbox or scratch org for safety.
      </p>
    </div>
    <a
      class="inline-flex items-center gap-2 rounded-xl bg-white px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm ring-1 ring-slate-200 hover:shadow-md"
      href="{{ '/' | relative_url }}"
    >
      ‚¨Ö Back to games
    </a>
  </div>

  <div class="grid gap-6 lg:grid-cols-3">
    <div class="lg:col-span-2 space-y-6">
      <div class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-slate-200">
        <div class="flex items-start justify-between gap-3 mb-4">
          <div>
            <h2 class="text-xl font-semibold text-slate-900">Login to Salesforce</h2>
            <p class="text-sm text-slate-600">Authenticate with username, password, and security token using JSforce.</p>
          </div>
          <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700 ring-1 ring-emerald-200">SOAP login</span>
        </div>
        <form id="login-form" class="space-y-4">
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="login-url">Login URL</label>
            <select id="login-url" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500">
              <option value="https://login.salesforce.com">Production / Developer</option>
              <option value="https://test.salesforce.com">Sandbox</option>
            </select>
            <p class="mt-1 text-xs text-slate-500">Choose the domain that matches your org (sandbox uses test.salesforce.com).</p>
          </div>
          <div class="grid gap-4 sm:grid-cols-2">
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="username">Username</label>
              <input id="username" type="email" autocomplete="username" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="password">Password</label>
              <input id="password" type="password" autocomplete="current-password" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
          </div>
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="token">Security Token</label>
            <input id="token" type="password" autocomplete="one-time-code" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            <p class="mt-1 text-xs text-slate-500">JSforce uses the SOAP login flow: concatenate your password + security token.</p>
          </div>
          <div class="flex flex-wrap items-center gap-3">
            <button type="submit" class="inline-flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-500 via-blue-600 to-indigo-700 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-blue-200 hover:shadow-xl">üöÄ Login</button>
            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm hover:shadow" id="logout" disabled>Sign out</button>
          </div>
        </form>
        <div id="login-status" class="mt-4 flex items-center gap-2 rounded-xl bg-slate-50 px-4 py-3 text-sm text-slate-700 ring-1 ring-slate-200">Waiting for login‚Ä¶</div>
        <div class="mt-3 rounded-xl bg-slate-900 px-4 py-3 text-sm text-slate-100 ring-1 ring-slate-800" id="session-output" aria-live="polite">Session details will appear here.</div>
      </div>

      <div class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-slate-200">
        <div class="flex items-start justify-between gap-3 mb-4">
          <div>
            <h2 class="text-xl font-semibold text-slate-900">Signup (create Lead)</h2>
            <p class="text-sm text-slate-600">After logging in, create a Lead to capture a signup with a single click.</p>
          </div>
          <span class="inline-flex items-center rounded-full bg-indigo-100 px-3 py-1 text-xs font-semibold text-indigo-700 ring-1 ring-indigo-200">API create</span>
        </div>
        <form id="signup-form" class="space-y-4">
          <div class="grid gap-4 sm:grid-cols-2">
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="first-name">First name</label>
              <input id="first-name" type="text" autocomplete="given-name" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="last-name">Last name</label>
              <input id="last-name" type="text" autocomplete="family-name" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
          </div>
          <div class="grid gap-4 sm:grid-cols-2">
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="email">Email</label>
              <input id="email" type="email" autocomplete="email" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
            <div>
              <label class="mb-1 block text-sm font-medium text-slate-800" for="company">Company / School</label>
              <input id="company" type="text" autocomplete="organization" value="JSforce Web Signup" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            </div>
          </div>
          <div class="flex flex-wrap items-center gap-3">
            <button type="submit" id="signup-btn" disabled class="inline-flex items-center gap-2 rounded-lg bg-gradient-to-r from-emerald-500 to-teal-600 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-200 hover:shadow-xl disabled:opacity-60">‚úèÔ∏è Create Lead</button>
            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm hover:shadow" id="clear-btn">Clear</button>
          </div>
        </form>
        <div id="signup-status" class="mt-4 flex items-center gap-2 rounded-xl bg-slate-50 px-4 py-3 text-sm text-slate-700 ring-1 ring-slate-200">Login first to enable signup.</div>
        <div class="mt-3 rounded-xl bg-slate-900 px-4 py-3 text-sm text-slate-100 ring-1 ring-slate-800" id="signup-output" aria-live="polite">Lead responses will appear here.</div>
        <ul class="mt-3 list-disc space-y-1 pl-5 text-sm text-slate-600">
          <li>Uses <code class="rounded bg-slate-100 px-1 py-0.5 text-xs">connection.sobject('Lead').create()</code> to store the signup.</li>
          <li>Requires a valid session from the Login panel.</li>
          <li>Great for testing Connected App + API perms in a sandbox.</li>
        </ul>
      </div>
    </div>

    <div class="space-y-6">
      <div class="rounded-2xl bg-white p-6 shadow-sm ring-1 ring-slate-200">
        <div class="flex items-start justify-between gap-3 mb-4">
          <div>
            <h2 class="text-xl font-semibold text-slate-900">SSO via Salesforce Provider</h2>
            <p class="text-sm text-slate-600">Launch OAuth with a Connected App and your Salesforce SSO provider.</p>
          </div>
          <span class="inline-flex items-center rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold text-sky-700 ring-1 ring-sky-200">OAuth 2.0</span>
        </div>
        <form id="sso-form" class="space-y-4">
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="sso-login-url">Login / My Domain URL</label>
            <input id="sso-login-url" type="url" value="https://login.salesforce.com" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            <p class="mt-1 text-xs text-slate-500">Use your My Domain for SSO (e.g. https://mydomain.my.salesforce.com).</p>
          </div>
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="sso-client-id">Connected App Client ID</label>
            <input id="sso-client-id" type="text" autocomplete="off" required class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            <p class="mt-1 text-xs text-slate-500">Uses the user-agent OAuth flow. Ensure the callback URL matches this page.</p>
          </div>
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="sso-redirect">Redirect URI</label>
            <input id="sso-redirect" type="url" class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            <p class="mt-1 text-xs text-slate-500">Defaults to this page URL; update only if your Connected App expects a different callback.</p>
          </div>
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="sso-provider">SSO Provider (optional)</label>
            <input id="sso-provider" type="text" placeholder="e.g. MySAMLProvider" class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
            <p class="mt-1 text-xs text-slate-500">Adds <code class="rounded bg-slate-100 px-1 py-0.5 text-xs">sso=&lt;provider&gt;</code> to the authorize URL to jump directly to your provider.</p>
          </div>
          <div>
            <label class="mb-1 block text-sm font-medium text-slate-800" for="sso-scope">OAuth scopes</label>
            <input id="sso-scope" type="text" value="api refresh_token web openid" class="block w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500" />
          </div>
          <div class="flex flex-col gap-3">
            <button type="submit" class="inline-flex items-center justify-center gap-2 rounded-lg bg-gradient-to-r from-sky-500 via-blue-500 to-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-200 hover:shadow-xl">üîë Start SSO Login</button>
            <button type="button" class="inline-flex items-center justify-center gap-2 rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-800 shadow-sm hover:shadow" id="sso-reset">Clear SSO settings</button>
          </div>
        </form>
        <div id="sso-status" class="mt-4 flex items-center gap-2 rounded-xl bg-slate-50 px-4 py-3 text-sm text-slate-700 ring-1 ring-slate-200">Use a Connected App to authorize via SSO.</div>
        <div class="mt-3 rounded-xl bg-slate-900 px-4 py-3 text-sm text-slate-100 ring-1 ring-slate-800" id="sso-output" aria-live="polite">OAuth details and session ID will appear here.</div>
      </div>

      <div class="rounded-2xl border border-dashed border-blue-200 bg-blue-50/60 p-4 text-sm text-slate-700">
        <div class="flex items-center gap-2 font-semibold text-blue-800">
          <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-white">‚ÑπÔ∏è</span>
          Quick tips
        </div>
        <ul class="mt-2 list-disc space-y-1 pl-5">
          <li>Keep this tab open during OAuth redirects; the page will parse tokens on return.</li>
          <li>Use sandbox credentials for experiments and testing.</li>
          <li>Copy responses from the dark panels above to share session details safely.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<script src="https://unpkg.com/jsforce@1.11.1/build/jsforce.min.js"></script>
<script>
  const loginForm = document.getElementById('login-form');
  const loginStatus = document.getElementById('login-status');
  const sessionOutput = document.getElementById('session-output');
  const logoutButton = document.getElementById('logout');
  const signupForm = document.getElementById('signup-form');
  const signupButton = document.getElementById('signup-btn');
  const clearButton = document.getElementById('clear-btn');
  const signupStatus = document.getElementById('signup-status');
  const signupOutput = document.getElementById('signup-output');
  const ssoForm = document.getElementById('sso-form');
  const ssoStatus = document.getElementById('sso-status');
  const ssoOutput = document.getElementById('sso-output');
  const ssoReset = document.getElementById('sso-reset');
  const ssoLoginUrl = document.getElementById('sso-login-url');
  const ssoClientId = document.getElementById('sso-client-id');
  const ssoRedirect = document.getElementById('sso-redirect');
  const ssoProvider = document.getElementById('sso-provider');
  const ssoScope = document.getElementById('sso-scope');

  let connection = null;

  function setStatus(target, message, type = '') {
    target.textContent = message;
    target.classList.remove('ok', 'error');
    if (type) target.classList.add(type);
  }

  function updateSessionOutput(data) {
    sessionOutput.textContent = JSON.stringify(data, null, 2);
  }

  function updateSignupOutput(data) {
    signupOutput.textContent = JSON.stringify(data, null, 2);
  }

  function updateSsoOutput(data) {
    ssoOutput.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
  }

  function parseHash(hash) {
    const params = new URLSearchParams((hash || '').replace(/^#/, ''));
    return Object.fromEntries(params.entries());
  }

  function defaultRedirectUri() {
    return window.location.href.split('#')[0];
  }

  async function handleOAuthResult(params) {
    if (params.access_token && params.instance_url) {
      try {
        connection = new jsforce.Connection({
          instanceUrl: params.instance_url,
          accessToken: params.access_token
        });
        const identity = await connection.identity();
        setStatus(loginStatus, `Logged in via SSO as ${identity.display_name} (${identity.username})`, 'ok');
        setStatus(ssoStatus, 'SSO success: session established.', 'ok');
        updateSessionOutput({
          instanceUrl: connection.instanceUrl,
          accessToken: connection.accessToken,
          identity,
          via: 'sso'
        });
        updateSsoOutput(params);
        logoutButton.disabled = false;
        signupButton.disabled = false;
        signupStatus.textContent = 'Ready to create Leads.';
        window.history.replaceState(null, '', defaultRedirectUri());
      } catch (error) {
        console.error(error);
        setStatus(ssoStatus, `SSO session validation failed: ${error.message}`, 'error');
        updateSsoOutput({ error: error.message, params });
      }
    } else if (params.error) {
      setStatus(ssoStatus, `SSO failed: ${params.error_description || params.error}`, 'error');
      updateSsoOutput(params);
    }
  }

  ssoRedirect.value = defaultRedirectUri();

  ssoForm.addEventListener('submit', (event) => {
    event.preventDefault();
    const loginUrl = ssoLoginUrl.value.trim().replace(/\/$/, '');
    const clientId = ssoClientId.value.trim();
    const redirectUri = (ssoRedirect.value || defaultRedirectUri()).trim();
    const scope = ssoScope.value.trim() || 'api refresh_token web openid';
    const provider = ssoProvider.value.trim();

    if (!loginUrl || !clientId) {
      setStatus(ssoStatus, 'Login URL and Client ID are required.', 'error');
      return;
    }

    const state = `sso-${Date.now()}`;
    const authorizeUrl = `${loginUrl}/services/oauth2/authorize?response_type=token&client_id=${encodeURIComponent(clientId)}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${encodeURIComponent(scope)}&state=${encodeURIComponent(state)}&prompt=login${provider ? `&sso=${encodeURIComponent(provider)}` : ''}`;

    setStatus(ssoStatus, 'Redirecting to Salesforce for SSO‚Ä¶');
    updateSsoOutput({ authorizeUrl, state, scope, provider: provider || 'default' });
    window.location.href = authorizeUrl;
  });

  ssoReset.addEventListener('click', () => {
    ssoForm.reset();
    ssoRedirect.value = defaultRedirectUri();
    setStatus(ssoStatus, 'Use a Connected App to authorize via SSO.');
    updateSsoOutput('Cleared SSO configuration.');
  });

  handleOAuthResult(parseHash(window.location.hash));

  loginForm.addEventListener('submit', async (event) => {
    event.preventDefault();
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;
    const token = document.getElementById('token').value;
    const loginUrl = document.getElementById('login-url').value;

    if (!username || !password || !token) {
      setStatus(loginStatus, 'Please fill username, password, and security token.', 'error');
      return;
    }

    setStatus(loginStatus, 'Connecting to Salesforce‚Ä¶');
    loginForm.querySelector('button[type="submit"]').disabled = true;

    try {
      connection = new jsforce.Connection({ loginUrl });
      const userInfo = await connection.login(username, password + token);
      const identity = await connection.identity();
      setStatus(loginStatus, `Logged in as ${identity.display_name} (${identity.username})`, 'ok');
      updateSessionOutput({
        instanceUrl: connection.instanceUrl,
        accessToken: connection.accessToken,
        userId: userInfo.id,
        organizationId: userInfo.organizationId,
        identity
      });
      logoutButton.disabled = false;
      signupButton.disabled = false;
      signupStatus.textContent = 'Ready to create Leads.';
    } catch (error) {
      console.error(error);
      setStatus(loginStatus, `Login failed: ${error.message}`, 'error');
      updateSessionOutput({ error: error.message });
      signupButton.disabled = true;
      signupStatus.textContent = 'Login first to enable signup.';
    } finally {
      loginForm.querySelector('button[type="submit"]').disabled = false;
    }
  });

  logoutButton.addEventListener('click', () => {
    connection = null;
    setStatus(loginStatus, 'Signed out.');
    updateSessionOutput('Session cleared.');
    logoutButton.disabled = true;
    signupButton.disabled = true;
    signupStatus.textContent = 'Login first to enable signup.';
    setStatus(ssoStatus, 'Use a Connected App to authorize via SSO.');
    updateSsoOutput('Session cleared.');
  });

  signupForm.addEventListener('submit', async (event) => {
    event.preventDefault();
    if (!connection) {
      setStatus(signupStatus, 'Login required before creating Leads.', 'error');
      return;
    }

    const firstName = document.getElementById('first-name').value.trim();
    const lastName = document.getElementById('last-name').value.trim();
    const email = document.getElementById('email').value.trim();
    const company = document.getElementById('company').value.trim();

    if (!firstName || !lastName || !email || !company) {
      setStatus(signupStatus, 'Fill all fields before submitting.', 'error');
      return;
    }

    setStatus(signupStatus, 'Creating Lead‚Ä¶');
    signupButton.disabled = true;

    try {
      const lead = await connection.sobject('Lead').create({
        FirstName: firstName,
        LastName: lastName,
        Company: company,
        Email: email,
        Description: 'Created from JSforce web signup console'
      });

      if (lead.success) {
        setStatus(signupStatus, `Lead created (Id: ${lead.id})`, 'ok');
        updateSignupOutput({ leadId: lead.id, firstName, lastName, email, company });
      } else {
        setStatus(signupStatus, 'Lead creation failed. Check API permissions.', 'error');
        updateSignupOutput(lead);
      }
    } catch (error) {
      console.error(error);
      setStatus(signupStatus, `Lead creation failed: ${error.message}`, 'error');
      updateSignupOutput({ error: error.message });
    } finally {
      signupButton.disabled = false;
    }
  });

  clearButton.addEventListener('click', () => {
    signupForm.reset();
    updateSignupOutput('Cleared form.');
    setStatus(signupStatus, connection ? 'Ready to create Leads.' : 'Login first to enable signup.');
  });
</script>
